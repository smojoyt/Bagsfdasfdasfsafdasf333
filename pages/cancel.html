<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Checkout Canceled – Karry Kraze</title>
  <link rel="icon" href="/imgs/Logo/Short/SL_0603.png" type="image/png" />

  <!-- SEO & Social Meta -->
  <meta name="description" content="Your checkout was canceled. Your cart is saved—pick up where you left off or keep shopping." />
  <meta property="og:title" content="Checkout Canceled – Karry Kraze" />
  <meta property="og:description" content="Your cart is saved. Resume checkout or continue shopping." />
  <meta property="og:image" content="/imgs/Logo/OG.jpg" />

  <!-- Tailwind CSS (CDN ok for dev; use CLI/PostCSS in prod) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @keyframes kkFadeUp { from { opacity: 0; transform: translateY(6px) } to { opacity: 1; transform: translateY(0) } }
    .animate-kk { animation: kkFadeUp .35s ease-out both; }
  </style>
</head>

<body class="bg-white text-black font-sans">

  <main class="px-6 py-36">
    <div class="max-w-[108rem] mx-auto">

      <!-- Banner -->
      <header id="signup-banner"
              class="relative w-full sm:h-[100px] lg:h-[200px] bg-center bg-cover bg-no-repeat flex items-center justify-center">
        <picture class="absolute inset-0 w-full h-full">
          <source media="(min-width:1024px)" srcset="/imgs/Banner/KK_01.jpg">
          <img src="/imgs/Banner/KK_01.jpg" alt="" class="w-full h-full object-cover" decoding="async" loading="lazy">
        </picture>
        <div class="relative z-10 text-center max-w-[90%] sm:max-w-[75%]">
          <h1 class="text-black bg-white m-4 px-3 py-2 sm:px-6 sm:py-3 font-bold tracking-wider uppercase text-2xl">
            Checkout Canceled
          </h1>
        </div>
      </header>

      <!-- Message + Signup Promo -->
      <section class="relative px-4 py-10 max-w-3xl mx-auto space-y-5 animate-kk">
        <p class="text-gray-700 text-base">
          No worries—nothing was charged and your cart is still saved on this device.
          You can resume checkout anytime or keep shopping.
        </p>

        <div class="bg-[#fef1e7] border border-black border-dashed px-5 py-5">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
            <p class="text-sm text-gray-900">
              🎁 <strong>Get $5 off</strong> your next order by signing up—your code will be emailed instantly.
            </p>
            <a id="kk-signup-link"
               class="inline-block bg-black hover:bg-gray-800 text-white px-5 py-2 text-sm text-center transition"
               href="#" rel="noopener">Get $5 Coupon</a>
          </div>
        </div>
      </section>

      <!-- Content Grid -->
      <section class="max-w-6xl mx-auto grid lg:grid-cols-3 gap-8 px-4 pb-12">

        <!-- Left: CTAs & Trust -->
        <div class="lg:col-span-1 space-y-6">

          <div class="space-y-3">
            <a href="/pages/catalog.html"
               class="block w-full bg-black hover:bg-gray-800 text-white py-3 text-center transition">
              Continue Shopping
            </a>

            <button id="kk-resume"
                    class="w-full border border-black py-3 text-center hover:bg-black hover:text-white transition">
              Resume Checkout
            </button>

            <a href="mailto:support@karrykraze.com"
               class="block text-center text-sm underline text-gray-700 hover:text-black">
              Need help? Email support@karrykraze.com
            </a>
          </div>

          <div class="border border-gray-200 p-4">
            <h4 class="text-sm font-semibold uppercase tracking-wide mb-3">Shop With Confidence</h4>
            <div class="grid grid-cols-3 gap-3 text-xs text-gray-700">
              <div class="flex flex-col items-center gap-2">
                <svg viewBox="0 0 24 24" class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M9 12l2 2 4-4" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="12" cy="12" r="9"></circle>
                </svg>
                Quality Checked
              </div>
              <div class="flex flex-col items-center gap-2">
                <svg viewBox="0 0 24 24" class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M12 1L3 5v6c0 5.25 3.438 10.125 9 12 5.563-1.875 9-6.75 9-12V5l-9-4z"></path>
                  <path d="M9 12l2 2 4-4" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Secure Checkout
              </div>
              <div class="flex flex-col items-center gap-2">
                <svg viewBox="0 0 24 24" class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M3 12h18M3 6h18M3 18h18" stroke-linecap="round"/>
                </svg>
                Transparent Pricing
              </div>
            </div>
          </div>

          <div class="border border-gray-200 p-4">
            <h4 class="text-sm font-semibold uppercase tracking-wide mb-3">Follow for Drops & Deals</h4>
            <div class="flex flex-wrap items-center gap-3 text-sm">
              <a href="https://instagram.com/karrykraze" target="_blank"
                 class="underline hover:no-underline">Instagram</a>
              <span class="text-gray-300">•</span>
              <a href="https://tiktok.com/@karrykraze" target="_blank"
                 class="underline hover:no-underline">TikTok</a>
              <span class="text-gray-300">•</span>
              <a href="https://pinterest.com/karrykraze" target="_blank"
                 class="underline hover:no-underline">Pinterest</a>
            </div>
          </div>
        </div>

        <!-- Right: Order Summary -->
        <div class="lg:col-span-2">
          <div class="border border-black">
            <div class="flex items-center justify-between px-4 py-3 bg-[#fff8f0]">
              <h3 class="text-base font-bold uppercase">Your Saved Cart</h3>
              <span id="kk-itemCount" class="text-sm text-gray-600">0 items</span>
            </div>

            <div id="kk-orderItems" class="divide-y">
              <div class="p-4 text-sm text-gray-500">Loading your items…</div>
            </div>

            <div id="kk-orderTotals" class="px-4 py-4 border-t hidden">
              <div class="flex justify-between text-sm">
                <span class="text-gray-600">Subtotal</span>
                <span id="kk-subtotal" class="font-medium">$0.00</span>
              </div>

              <!-- Informational potential discount line (not applied automatically) -->
              <div id="kk-potentialLine" class="flex justify-between text-sm hidden">
                <span class="text-gray-600">Potential $5 off (after email signup)</span>
                <span id="kk-potential" class="font-medium">-$0.00</span>
              </div>

              <div class="flex justify-between text-base font-bold mt-2">
                <span>Total (est.)</span>
                <span id="kk-total">$0.00</span>
              </div>
              <p class="text-xs text-gray-500 mt-2">
                Taxes & shipping calculated at checkout. Coupon will be applied at checkout after signup.
              </p>
            </div>
          </div>

          <p id="kk-reminder" class="text-xs text-gray-500 mt-3">
            Cart items are saved on this device for 7 days.
          </p>
        </div>
      </section>

      <!-- Contact Prompt -->
      <section class="mt-4 max-w-3xl mx-auto bg-white border border-black border-dashed p-6 shadow text-center">
        <h3 class="text-xl font-bold uppercase mb-2">Questions or feedback?</h3>
        <p class="text-sm text-gray-700 mb-4">
          We’re here to help—and we love hearing from you!
        </p>
        <a href="mailto:support@karrykraze.com"
           class="inline-block bg-black hover:bg-gray-800 text-white px-6 py-2 transition">
          Contact Support
        </a>
      </section>

    </div>
  </main>

  <!-- Mounts -->
  <div id="footer"></div>
  <div id="navbar"></div>
  <div id="announcement-container"></div>

  <!-- Your main bundle (for navbar/footer, etc.) -->
  <script type="module" src="/js/main.js"></script>

  <script>
    /**
     * Cancel Page Logic (signup-based $5 coupon)
     * - Uses a dev link you provided for signup when running on localhost/127.0.0.1
     * - Uses /pages/sign-up.html in production
     * - Shows a potential $5 off line (informational only)
     */

    // 1) Signup link routing
    const SIGNUP_URL =
      (location.hostname === '127.0.0.1' || location.hostname === 'localhost')
        ? 'http://127.0.0.1:5500/pages/sign-up.html'
        : '/pages/sign-up.html';

    document.getElementById('kk-signup-link')?.setAttribute('href', SIGNUP_URL);

    // 2) Cart rendering
    const ITEMS_CONTAINER = document.getElementById('kk-orderItems');
    const TOTALS = document.getElementById('kk-orderTotals');
    const SUBTOTAL_EL = document.getElementById('kk-subtotal');
    const TOTAL_EL = document.getElementById('kk-total');
    const COUNT_EL = document.getElementById('kk-itemCount');

    const POTENTIAL_LINE = document.getElementById('kk-potentialLine');
    const POTENTIAL_EL = document.getElementById('kk-potential');

    const cart = JSON.parse(localStorage.getItem('savedCart')) ||
                 JSON.parse(localStorage.getItem('cart')) || [];

    const money = n => `$${(Math.round(n * 100) / 100).toFixed(2)}`;

    function render() {
      ITEMS_CONTAINER.innerHTML = '';
      if (!Array.isArray(cart) || cart.length === 0) {
        COUNT_EL.textContent = '0 items';
        ITEMS_CONTAINER.innerHTML = '<div class="p-4 text-sm text-gray-500">Your cart is empty.</div>';
        return;
      }

      let subtotal = 0;
      cart.forEach((item) => {
        const qty = Number(item.qty || 1);
        const price = Number(item.price || 0);
        const lineTotal = price * qty;
        subtotal += lineTotal;

        const row = document.createElement('div');
        row.className = 'p-4 flex items-center gap-4';
        row.innerHTML = `
          <img src="${item.image || item.catalogImage || '/imgs/Logo/Short/4.jpg'}"
               alt="${item.name || 'Item'}"
               class="w-14 h-14 rounded object-cover border" />
          <div class="min-w-0">
            <p class="text-sm font-medium truncate">${item.name || 'Item'} ${item.variant ? `– ${item.variant}` : ''}</p>
            <p class="text-xs text-gray-500">Qty: ${qty}</p>
          </div>
          <div class="ml-auto text-sm font-semibold">${money(lineTotal)}</div>
        `;
        ITEMS_CONTAINER.appendChild(row);
      });

      COUNT_EL.textContent = `${cart.length} ${cart.length === 1 ? 'item' : 'items'}`;
      SUBTOTAL_EL.textContent = money(subtotal);

      // Show potential $5 coupon line only if subtotal >= $5
      if (subtotal >= 5) {
        POTENTIAL_EL.textContent = `-${money(5)}`;
        POTENTIAL_LINE.classList.remove('hidden');
        TOTAL_EL.textContent = money(subtotal); // Not applying it—just showing normal subtotal
      } else {
        POTENTIAL_LINE.classList.add('hidden');
        TOTAL_EL.textContent = money(subtotal);
      }

      TOTALS.classList.remove('hidden');
    }

    render();

    // 3) Resume Checkout (wire to your cart or Stripe flow)
    document.getElementById('kk-resume')?.addEventListener('click', () => {
      // Example fallback; replace with your cart drawer event or checkout flow:
      // window.dispatchEvent(new CustomEvent('kk:openCart'));
      // or e.g. window.location.href = '/pages/cart.html';
      window.location.href = '/pages/catalog.html';
    });
  </script>

</body>
</html>
